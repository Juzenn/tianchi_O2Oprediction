setwd('E:\OneDrive\Documents\_Sufelearning\Bigdata\tianchi_O2Oprediction')
setwd(r'E:\OneDrive\Documents\_Sufelearning\Bigdata\tianchi_O2Oprediction')
setwd('E:\\OneDrive\\Documents\\_Sufelearning\\Bigdata\\tianchi_O2Oprediction')
data<-read.table('aaa.txt',header=T)
View(data)
data<-read.table('aaa.txt',header=T,sep = ',')
View(data)
dist<-1/(data$distance+0.5)
rate<-1/(data$rate_level+5)
y<-data$pab
summary(lm(y~cbind(dist,rate)))
rate
dist
plot(dist)
plot(rate)
rate
plot(sort(rate))
plot(rate,y)
plot(dist,y)
r<-summary(lm(y~cbind(dist,rate)))
lmsummary<-summary(lm(y~cbind(dist,rate)))
lmsummary$residuals
plot(lmsummary$residuals)
hist(lmsummary$residuals)
hist(lmsummary$residuals,100)
hist(lmsummary$residuals,50)
hist(lmsummary$residuals,50)
density(lmsummary$residuals)
cov(x1,x2)
cov(dist,rate)
cov(y,rate)
cov(y,dist)
cor(lmsummary$residuals,dist)
cor(lmsummary$residuals,rate)
cor(lmsummary$residuals,y)
lmsummary$coefficients
lmsummary$coefficients[,1]
cbind(rep(1,length(y)),dist,rate)
lmsummary$coefficients[,1]%*%cbind(rep(1,length(y)),dist,rate)
cbind(rep(1,length(y)),dist,rate)%*%lmsummary$coefficients[,1]
cor(y,cbind(rep(1,length(y)),dist,rate)%*%lmsummary$coefficients[,1])
cor(lmsummary$residuals,cbind(rep(1,length(y)),dist,rate)%*%lmsummary$coefficients[,1])
hist(lmsummary$residuals,50)
var(lusummary$residual)
var(lusummary$residuals)
var(lmsummary$residuals)
length(y)
pi
X<-cbind(dist,rate)
X<-cbind(data$distance,data$rate)
X
X1<-data$distance
X2<-data$rate_level
n<-110
n<-length(y)
loglikefun<-function(p)  {
sigma<-p[6];
mu<-p[3:5]
X<-cbind(rep(1,n),1/(X1+p[1]),1/(X2+p[2]))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
mle<-maxLik(logLik=loglikefun, start=c(0.5,5,0.01,0.04,0.62,0.002))
install.packages('maxLik')
install.packages('maxLik')
mle<-maxLik(logLik=loglikefun, start=c(0.5,5,0.01,0.04,0.62,0.002))
library(maxLik)
mle<-maxLik(logLik=loglikefun, start=c(0.5,5,0.01,0.04,0.62,0.002))
summary(mle)
mle<-maxLik(logLik=loglikefun, start=c(0.5,2,0.01,0.04,0.62,0.002))
#install.packages('maxLik')
summary(mle)
loglikefun<-function(p)  {
sigma<-p[6];
mu<-p[3:5]
X<-cbind(rep(1,n),1/(X1+p[1]),rate)
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
mle<-maxLik(logLik=loglikefun, start=c(0.5,2,0.01,0.04,0.62,0.002))
#install.packages('maxLik')
summary(mle)
loglikefun<-function(p)  {
sigma<-p[5];
mu<-p[2:4]
X<-cbind(rep(1,n),1/(X1+p[1]),rate)
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
mle<-maxLik(logLik=loglikefun, start=c(0.5,0.01,0.04,0.62,0.002))
#install.packages('maxLik')
summary(mle)
loglikefun<-function(p)  {
sigma<-p[5];
mu<-p[2:4]
X<-cbind(rep(1,n),1/(X1+p[1]),1/X2)
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
library(maxLik)
mle<-maxLik(logLik=loglikefun, start=c(0.5,0.01,0.04,0.62,0.002))
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
X<-cbind(rep(1,n),1/(X1+0.667),1/(X2+5))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
library(maxLik)
mle<-maxLik(logLik=loglikefun, start=c(0.01,0.04,0.62,0.002))
#install.packages('maxLik')
summary(mle)
mle
summary(mle)$f
a<-summary(mle)
a$constraints
a$iterations
a$returnCode
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
X<-cbind(rep(1,n),1/(X1+0.667),1/(X2+32))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
library(maxLik)
mle<-maxLik(logLik=loglikefun, start=c(0.01,0.04,0.62,0.02))
#install.packages('maxLik')
a<-summary(mle)
a
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
X<-cbind(rep(1,n),1/(X1+p[5]),1/(X2+p[6]))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
#library(maxLik)
mle<-maxLik(logLik=loglikefun, start=c(0.01,0.04,0.62,0.02,0.667,32))
#install.packages('maxLik')
a<-summary(mle)
a
mle<-maxLik(logLik=loglikefun, start=c(0.01,0.04,0.62,0.02,0.666962,32.801582))
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
X<-cbind(rep(1,n),1/(X1+0.666962),1/(X2+32.801582))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
#library(maxLik)
mle<-maxLik(logLik=loglikefun, start=c(0.01,0.04,0.62,0.02))
#install.packages('maxLik')
a<-summary(mle)
a
a$estimate
a$estimate[,1]
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
# X<-cbind(rep(1,n),1/(X1+0.666962),1/(X2+32.801582))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
X<-cbind(rep(1,n),1/(X1+0.666962),1/(X2+32.801582))
X1<-data$distance
X2<-data$rate_level
n<-length(y)
X<-cbind(rep(1,n),1/(X1+0.666962),1/(X2+32.801582))
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
# X<-cbind(rep(1,n),1/(X1+0.666962),1/(X2+32.801582))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(y-X%*%mu)%*%(y-X%*%mu)
}
mle<-maxLik(logLik=loglikefun, start=c(0.01,0.04,0.62,0.02))
#install.packages('maxLik')
a<-summary(mle)
X%*%a$estimate[1:3,1]
cor(y,X%*%a$estimate[1:3,1])
cor(y,y-X%*%a$estimate[1:3,1])
diag(1,nrow(X))
diag(rep(1,nrow(X)))
e=diag(rep(1,nrow(X)))
View(e)
M<-function(X){
diag(rep(1,nrow(X)))-X%*%solve(t(X)%*%X)%*%t(X)
}
det(M(X))
det(M(rep(1,nrow(X))))
M(rep(1,nrow(X))
)
rep(1,nrow(X)
)
X<-as.matrix(X)
X
rep(1,nrow(X))
as.matrix(rep(1,nrow(X)))
M<-function(X){
X<-as.matrix(X)
diag(rep(1,nrow(X)))-X%*%solve(t(X)%*%X)%*%t(X)
}
M(rep(1,nrow(X))
M(rep(1,nrow(X)))
M(rep(1,nrow(X)))
det(M(rep(1,nrow(X))))
Mi<-M(rep(1,nrow(X)))
t(y)%*%Mi%*%y
yhat<-X%*%a$estimate[1:3,1]
yhat
t(yhat)%*%M(X)%*%yhat
dist<-1/(data$distance+0.666962)
rate<-1/(data$rate_level+32.801582)
y<-data$pab
lmsummary<-summary(lm(y~cbind(dist,rate)))
lmsummary
plot(y-yhat)
hist(y-yhat)
hist(y-yhat,50)
epsilon<-y-X%*%a$estimate[1:3,1]
ehat<-y-X%*%a$estimate[1:3,1]
t(ehat)%*%ehat
as.matrix(X)
t(X)%*%X
solve(t(X)%*%X)
X%*%solve(t(X)%*%X)%*%t(X)
t(X)%*%solve(t(X)%*%X)%*%X
t(y)%*%M(X)%*%y/t(y)%*%Mi%*%y
lmsummary
1-t(y)%*%M(X)%*%y/t(y)%*%Mi%*%y
help(maxLik)
log(10*y)
summary(lm(log(y)~cbind(log(dist),log(rate))))
dist<-log(data$distance+0.666962)
rate<-log(data$rate_level+32.801582)
y<-data$pab
lmsummary<-summary(lm(y~cbind(dist,rate)))
lmsummary
y<-log(data$pab)
lmsummary<-summary(lm(y~cbind(dist,rate)))
lmsummary
dist<-log(data$distance)#+0.666962)
rate<-log(data$rate_level)#+32.801582)
y<-log(data$pab)
lmsummary<-summary(lm(y~cbind(dist,rate)))
lmsummary
dist<-log(data$distance+0.666962)
rate<-log(data$rate_level+32.801582)
y<-log(data$pab)
lmsummary<-summary(lm(y~cbind(dist,rate)))
lmsummary
hist(lmsummary$residuals,50)
density(lmsummary$residuals)
length(y)
cor(lmsummary$residuals,cbind(rep(1,length(y)),dist,rate)%*%lmsummary$coefficients[,1])
X1<-data$distance
X2<-data$rate_level
n<-length(y)
#X<-cbind(rep(1,n),log(X1+0.666962),log(X2+32.801582))
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
X<-cbind(rep(1,n),log(X1+p[5]),log(X2+p[6]))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(log(y)-X%*%mu)%*%(log(y)-X%*%mu)
}
mle<-maxLik(logLik=loglikefun, start=c(0.01,0.04,0.62,0.02,0.66,32))
a<-summary(mle)
a
lmsummary
cov(lmsummary$residuals)
var(lmsummary$residuals)
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.2,0.66,32))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04,0.66,32))
y<-data$pab
lmsummary<-summary(lm(log(y)~cbind(dist,rate)))
lmsummary
hist(lmsummary$residuals,50)
var(lmsummary$residuals)
length(y)
cor(lmsummary$residuals,cbind(rep(1,length(y)),dist,rate)%*%lmsummary$coefficients[,1])
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
X<-cbind(rep(1,n),log(X1+p[5]),log(X2+p[6]))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(log(y)-X%*%mu)%*%(log(y)-X%*%mu)
}
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04,0.66,32))
a<-summary(mle)
a
warnings()
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04,0.37,13))
warnings()
X1
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04,0.37598,13))
warnings()
X<-cbind(rep(1,n),log(X1+0.37598),log(X2+13.06202))
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
# X<-cbind(rep(1,n),log(X1+p[5]),log(X2+p[6]))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(log(y)-X%*%mu)%*%(log(y)-X%*%mu)
}
X<-cbind(rep(1,n),log(X1+0.37598),log(X2+13.06202))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04))#,0.37598,13))
a<-summary(mle)
a<-summary(mle)
a
dist<-log(data$distance+0.37598)
rate<-log(data$rate_level+13.06202)
y<-data$pab
lmsummary<-summary(lm(log(y)~cbind(dist,rate)))
lmsummary
dist<-log(data$distance+0.38)
rate<-log(data$rate_level+13.06202)
y<-data$pab
lmsummary<-summary(lm(log(y)~cbind(dist,rate)))
lmsummary
X<-cbind(rep(1,n),log(X1+0.38),log(X2+13.06202))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04))#,0.37598,13))
(a<-summary(mle))
X<-cbind(rep(1,n),log(X1+0.37598),log(X2+13.06202))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04))#,0.37598,13))
(a<-summary(mle))
X<-cbind(rep(1,n),log(X1+0.38),log(X2+14))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04))#,0.37598,13))
(a<-summary(mle))
X<-cbind(rep(1,n),log(X1+0.38),log(X2+12))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04))#,0.37598,13))
(a<-summary(mle))
X<-cbind(rep(1,n),log(X1+0.37),log(X2+12))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04))#,0.37598,13))
(a<-summary(mle))
X<-cbind(rep(1,n),log(X1+0.37),log(X2+14))
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04))#,0.37598,13))
(a<-summary(mle))
loglikefun<-function(p)  {
sigma<-p[4];
mu<-p[1:3]
X<-cbind(rep(1,n),log(X1+p[5]),log(X2+p[6]))
-n*log(2*pi)-n*log(sigma^2)-(1/(2*sigma^2))*t(log(y)-X%*%mu)%*%(log(y)-X%*%mu)
}
mle<-maxLik(logLik=loglikefun, start=c(2.89,-0.5,-1.22,0.04,10,2))
(a<-summary(mle))
mle<-maxLik(logLik=loglikefun, start=c(1,-0.43,-0.91,0.3,0.37598,13.06208))
(a<-summary(mle))
dist<-log(data$distance+0.37598)
rate<-log(data$rate_level+13.06200)
lmsummary<-summary(lm(log(y)~cbind(dist,rate)))
lmsummary
cov(X)
help(glm)
glm(y1~cbind(X1,X2),family=binomial(link="logit"))
glm(y~cbind(X1,X2),family=binomial(link="logit"))
glm(y>0.5~cbind(X1,X2),family=binomial(link="logit"))
y>0.5
y>0.1
glm(as.numeric(y>0.1)~cbind(X1,X2),family=binomial(link="logit"))
